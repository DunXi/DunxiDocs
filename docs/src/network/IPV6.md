# IPV6技术

为了解决ipv4地址不够用的问题

![image-20230209114838446](/Users/dunxi/Library/Application Support/typora-user-images/image-20230209114838446.png)

## IPv6地址

ipv6地址的长度为128bit。**一般用冒号分割为8段**，每一段16bit，每一段内用十六进制表示，一个16进制数可以转换为4位二进制数。

IPv6地址中的字母大小写不敏感，A等同于a

ipv6也用IPv6/子网号



### 地址转换

05AD

0000 0101 1010 1101

CDEF

1100 1101 1110 1111

0DB8

0000 1101 1011 1000

| 十六进制 | 二进制 |
| -------- | ------ |
| 0        | 0000   |
| 1        | 0001   |
| 2        | 0010   |
| 3        | 0011   |
| 4        | 0100   |
| 5        | 0101   |
| 6        | 0110   |
| 7        | 0111   |
| 8        | 1000   |
| 9        | 1001   |
| A        | 1010   |
| B        | 1011   |
| C        | 1100   |
| D        | 1101   |
| E        | 1110   |
| F        | 1111   |



## IPv6地址缩写规范

​	为了书写方便，IPv6技术可以采用以下规则进行缩写。

- 每组16bit的单元的前导0可以省略，但是如果16bit单元的所有bit都为0，那么至少要保留一个0字符，拖尾的0不能被省略。

- 一个或多个连续的16bit字符为0时，可用"::"表示，但整个IPv6地址缩写中只允许有一个"::"。

  注意：如果整个IPv6地址中写了多个"::"则可能出现不确定每个符号缩减了几个0，只能表知道这几个符号一共缩减了几个0.



## IPv6地址分类

​	ipv6地址里面没有广播地址

### 组播地址

### 单播地址

#### 	全球单播地址

​		2000::/3

#### 	唯一本地地址

​		FD00::/8

#### 	链路本地地址

​		FE80::/10

#### 	特殊地址

#### 	其他单播地址

### 任博地址



## IPv6单播地址结构

​	一个IPv6单播地址可以分为两种结构

- 网络前缀：相当于IPv4中的网络位
  - n bit

- 接口标识：相当于主机位
  - 128 - n bit



### IPv6单播地址接口标识

- 接口标识可以通过三种方法生成
  - 手工配置
  - 系统自动生成
  - 通过IEEE EUI-64规范生成
- 其中EUI-64规范最为常用，此规范将接口的Mac地址转换为IPv6接口标识。
  - EUI-64
    - 将Mac地址第7bit取反
    - 在Mac地址中间加入FFFE,然后转成16进制

#### EUI-64练习

72DE-9862-2A3F

0111 0010 1101 1110 1001 1000   1111 1111 1111 1110   0110 0010 0010 1010 0011 11111

70 DE 98 FF FE 62 2a 3f



DB 86 9c FFFE 88 ef aa

1101 1001 - 1000 0110 - 1001 1100 -11111111-11111110- 1000 1000- 1110 1111 - 1010 1010

D9 86 9c ff fe 88 ef aa

冒号分十六进制

D986:9CFF:FE88:EFAA



## IPv6组播地址

​	ipv6组播地址表示多个接口，一般用于一对多的通信场景。

​	ipv6组播地址只可以作为ipv6报文的目的地址。组播



### 被请求节点的组播地址

​	当一个节点有了单播或任播地址，就会对应生成一个被请求节点组播地址，并且两端设备会加入加入到同一个组播组。该地址主要用于**邻居发现**（相当于ipv4中的arp）和**地址重复检测**（相当于ipv4中的免费arp）功能。被请求节点组播地址的有效范围为本地链路范围。

#### 生成方法

​	前104bit固定（**FF02开头**），后24bit由单播地址的后24bit拷贝而来。



## IPv6任播地址

​	任播地址标识一组网络，不常用





## IPv6单播地址的业务流程（重点）

​	一个接口在发送IPv6报文之前要经历地址配置、DAD、地址解析这三个阶段，NDP

1. 配置地址
   1. 全球单播地址
      1. 手工配置
      2. 无状态
      3. 有状态
   2. 链路本地地址
      1. 手工配置
      2. 自动生成
2. DAD检测重复（检测是否存在重复IP）
3. 地址解析（相当于ARP求Mac地址）来获取对方的Mac地址



开启ipv6

![image-20230216113552117](/Users/dunxi/Library/Application Support/typora-user-images/image-20230216113552117.png)

接口开启ipv6功能

![image-20230216113922788](/Users/dunxi/Library/Application Support/typora-user-images/image-20230216113922788.png)

查看ipv6路由表

![image-20230216113825396](/Users/dunxi/Library/Application Support/typora-user-images/image-20230216113825396.png)



##### 检测是否通信

ping+ipv6地址

ping 2000::1



#### 有状态地址配置

通过DHCPv6报文交互，DHCPv6服务器端自动
